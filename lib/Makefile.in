#
# Copyright (C) 2001 Sistina Software (UK) Limited.
#
# This file is released under the LGPL.
#

srcdir = @srcdir@
top_srcdir = @top_srcdir@
VPATH = @srcdir@
interface = @interface@

SOURCES=libdm-common.c $(interface)/libdevmapper.c

INCLUDES=-I$(interface)

LIB_STATIC = $(interface)/libdevmapper.a
LIB_SHARED = $(interface)/libdevmapper.so

TARGETS = $(LIB_STATIC) $(LIB_SHARED)

include ../make.tmpl


install: install_@interface@
	$(LN_S) -f libdevmapper.so.$(LIB_VERSION) $(libdir)/libdevmapper.so
	$(INSTALL) -D -o $(OWNER) -g $(GROUP) -m 444 libdevmapper.h \
		$(includedir)/libdevmapper.h

install_static: install_@interface@_static
	$(LN_S) -f libdevmapper.a.$(LIB_VERSION) $(libdir)/libdevmapper.a
	$(INSTALL) -D -o $(OWNER) -g $(GROUP) -m 444 libdevmapper.h \
		$(includedir)/libdevmapper.h


.PHONY: install install_@interface@ install_static install_@interface@_static

install_fs: fs/libdevmapper.so
	$(INSTALL) -D -o $(OWNER) -g $(GROUP) -m 555 $(STRIP) $< \
		$(libdir)/libdevmapper.so.$(LIB_VERSION)

install_ioctl: ioctl/libdevmapper.so
	$(INSTALL) -D -o $(OWNER) -g $(GROUP) -m 555 $(STRIP) $< \
		$(libdir)/libdevmapper.so.$(LIB_VERSION)

install_ioctl_static: ioctl/libdevmapper.a
	$(INSTALL) -D -o $(OWNER) -g $(GROUP) -m 555 $(STRIP) $< \
		$(libdir)/libdevmapper.a.$(LIB_VERSION)

distclean_lib: 
	$(RM) libdm-common.h

distclean: distclean_lib

.PHONY: distclean_lib distclean

